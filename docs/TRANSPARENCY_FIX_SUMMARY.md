# é€æ˜çª—å£ä¿®å¤æ€»ç»“

## é—®é¢˜æè¿°

é”®ç›˜æŒ‰é”®è¦†ç›–å±‚çª—å£å‡ºç°éš¾çœ‹çš„ç™½è‰²åº•è¾¹ï¼Œå½±å“è§†è§‰æ•ˆæœï¼Œå¹¶ä¸”å¯èƒ½é˜»æ­¢ç”¨æˆ·ç‚¹å‡»çª—å£ä¸‹æ–¹çš„å…¶ä»–åº”ç”¨ã€‚

## è§£å†³æ–¹æ¡ˆ

### 1. HTML å±‚é¢é€æ˜åŒ–

**æ–‡ä»¶ï¼š** `src/renderer/keyboardOverlay.html`

**ä¿®æ”¹ï¼š**
```html
<style>
  * {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
  }
  html,
  body {
    width: 100%;
    height: 100%;
    background: transparent !important;
    overflow: hidden;
  }
  #app {
    width: 100%;
    height: 100%;
    background: transparent !important;
  }
</style>
```

**æ•ˆæœï¼š**
- âœ… ç§»é™¤ HTML å’Œ body çš„é»˜è®¤ç™½è‰²èƒŒæ™¯
- âœ… ç¡®ä¿ #app å®¹å™¨ä¹Ÿæ˜¯é€æ˜çš„
- âœ… ä½¿ç”¨ `!important` ç¡®ä¿æ ·å¼ä¼˜å…ˆçº§

### 2. Vue ç»„ä»¶é€æ˜åŒ–

**æ–‡ä»¶ï¼š** `src/renderer/src/pages/keyboardOverlay/App.vue`

**ä¿®æ”¹ï¼š**
```vue
<!-- æ·»åŠ å…¨å±€æ ·å¼ -->
<style>
* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  background: transparent !important;
  overflow: hidden;
}

#app {
  width: 100vw;
  height: 100vh;
  background: transparent !important;
}
</style>

<!-- ä¿®æ”¹æ ¹å…ƒç´ æ ·å¼ -->
<style scoped>
.keyboard-overlay {
  position: fixed;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  pointer-events: none;
  background: transparent;
}
</style>
```

**æ•ˆæœï¼š**
- âœ… å…¨å±€æ ·å¼ç¡®ä¿ body å’Œ #app é€æ˜
- âœ… æ ¹å…ƒç´ ä½¿ç”¨ fixed å®šä½è¦†ç›–æ•´ä¸ªçª—å£
- âœ… æ‰€æœ‰èƒŒæ™¯éƒ½è®¾ç½®ä¸ºé€æ˜

### 3. çª—å£é…ç½®ä¼˜åŒ–

**æ–‡ä»¶ï¼š** `src/main/win/keyboardOverlayWin.ts`

**ä¿®æ”¹ï¼š**
```typescript
// ç§»é™¤æœªä½¿ç”¨çš„å˜é‡
const { height: screenHeight } = primaryDisplay.bounds;
```

**å·²æœ‰é…ç½®ï¼ˆä¿æŒä¸å˜ï¼‰ï¼š**
```typescript
super({
  frame: false,
  transparent: true,
  alwaysOnTop: true,
  skipTaskbar: true,
  hasShadow: false,
  focusable: false,
  // ...
});

this.win?.setIgnoreMouseEvents(true, { forward: true });
```

**æ•ˆæœï¼š**
- âœ… çª—å£å®Œå…¨é€æ˜
- âœ… ç‚¹å‡»äº‹ä»¶å®Œå…¨ç©¿é€
- âœ… ä¸å½±å“ä¸‹å±‚åº”ç”¨

## æŠ€æœ¯åŸç†

### é€æ˜åº¦å±‚æ¬¡ç»“æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Electron çª—å£                       â”‚  â† transparent: true
â”‚  â”œâ”€ HTML                            â”‚  â† background: transparent
â”‚  â”‚  â”œâ”€ body                         â”‚  â† background: transparent !important
â”‚  â”‚  â”‚  â”œâ”€ #app                      â”‚  â† background: transparent !important
â”‚  â”‚  â”‚  â”‚  â””â”€ .keyboard-overlay     â”‚  â† background: transparent
â”‚  â”‚  â”‚  â”‚     â””â”€ .container (ç£¨ç»ç’ƒ) â”‚  â† rgba(0,0,0,0.4) + blur
â”‚  â”‚  â”‚  â”‚        â””â”€ .badge (æŒ‰é”®)    â”‚  â† rgba(255,255,255,0.15) + blur
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ç‚¹å‡»ç©¿é€æœºåˆ¶

**Electron å±‚é¢ï¼š**
```typescript
setIgnoreMouseEvents(true, { forward: true })
```
- å¿½ç•¥æ‰€æœ‰é¼ æ ‡äº‹ä»¶
- å°†äº‹ä»¶è½¬å‘ç»™ä¸‹å±‚çª—å£

**CSS å±‚é¢ï¼š**
```css
pointer-events: none
```
- DOM å…ƒç´ ä¸æ•è·é¼ æ ‡äº‹ä»¶
- ä¸ Electron é…ç½®é…åˆä½¿ç”¨

## ä¿®æ”¹æ–‡ä»¶æ¸…å•

### ä¿®æ”¹çš„æ–‡ä»¶
1. âœ… `src/renderer/keyboardOverlay.html` - æ·»åŠ é€æ˜æ ·å¼
2. âœ… `src/renderer/src/pages/keyboardOverlay/App.vue` - æ·»åŠ å…¨å±€é€æ˜æ ·å¼
3. âœ… `src/main/win/keyboardOverlayWin.ts` - ç§»é™¤æœªä½¿ç”¨å˜é‡

### æ–°å¢çš„æ–‡æ¡£
1. âœ… `docs/TRANSPARENT_WINDOW_SETUP.md` - é€æ˜çª—å£é…ç½®è¯¦è§£
2. âœ… `docs/TRANSPARENCY_FIX_SUMMARY.md` - æœ¬æ–‡æ¡£

### æ›´æ–°çš„æ–‡æ¡£
1. âœ… `docs/KEYBOARD_HIGHLIGHT_FEATURE.md` - æ·»åŠ é€æ˜çª—å£è¯´æ˜

## éªŒè¯æ¸…å•

### è§†è§‰æ£€æŸ¥
- [ ] çª—å£èƒŒæ™¯å®Œå…¨é€æ˜ï¼Œæ— ç™½è‰²åº•è¾¹
- [ ] åªèƒ½çœ‹åˆ°ç£¨ç»ç’ƒå®¹å™¨å’ŒæŒ‰é”®å¾½ç« 
- [ ] ç£¨ç»ç’ƒæ•ˆæœæ­£å¸¸æ˜¾ç¤º
- [ ] æŒ‰é”®åŠ¨ç”»æµç•…

### åŠŸèƒ½æ£€æŸ¥
- [ ] å¯ä»¥ç‚¹å‡»çª—å£ä¸‹æ–¹çš„å…¶ä»–åº”ç”¨
- [ ] æŒ‰é”®æ˜¾ç¤ºæ­£å¸¸å·¥ä½œ
- [ ] æŒ‰é”®è‡ªåŠ¨æ·¡å‡ºå’Œç§»é™¤
- [ ] ä¸å½±å“å…¶ä»–çª—å£æ“ä½œ

### æŠ€æœ¯æ£€æŸ¥
- [ ] æ— ç¼–è¯‘é”™è¯¯
- [ ] æ— è¿è¡Œæ—¶é”™è¯¯
- [ ] æ§åˆ¶å°æ— è­¦å‘Š
- [ ] æ€§èƒ½æ­£å¸¸

## æµ‹è¯•æ­¥éª¤

1. **å¯åŠ¨åº”ç”¨**
   ```bash
   pnpm run dev
   ```

2. **å¼€å§‹å½•åˆ¶**
   - é€‰æ‹©å…¨å±å½•åˆ¶æˆ–åŒºåŸŸå½•åˆ¶
   - ç‚¹å‡»å¼€å§‹å½•åˆ¶æŒ‰é’®

3. **æµ‹è¯•é€æ˜åº¦**
   - è§‚å¯Ÿå·¦ä¸‹è§’æ˜¯å¦åªæ˜¾ç¤ºç£¨ç»ç’ƒå®¹å™¨
   - æ£€æŸ¥æ˜¯å¦æœ‰ç™½è‰²èƒŒæ™¯æˆ–è¾¹æ¡†
   - ç¡®è®¤çª—å£å…¶ä»–åŒºåŸŸå®Œå…¨é€æ˜

4. **æµ‹è¯•ç‚¹å‡»ç©¿é€**
   - å°è¯•ç‚¹å‡»è¦†ç›–å±‚çª—å£çš„é€æ˜åŒºåŸŸ
   - ç¡®è®¤èƒ½å¤Ÿç‚¹å‡»åˆ°ä¸‹å±‚åº”ç”¨
   - éªŒè¯ä¸‹å±‚åº”ç”¨æ­£å¸¸å“åº”

5. **æµ‹è¯•æŒ‰é”®æ˜¾ç¤º**
   - æŒ‰ä¸‹é”®ç›˜æŒ‰é”®
   - è§‚å¯ŸæŒ‰é”®æ˜¯å¦æ­£å¸¸æ˜¾ç¤º
   - æ£€æŸ¥åŠ¨ç”»æ•ˆæœæ˜¯å¦æµç•…

6. **åœæ­¢å½•åˆ¶**
   - åœæ­¢å½•åˆ¶
   - æŸ¥çœ‹è§†é¢‘ç¡®è®¤æ•ˆæœ

## å¯¹æ¯”æ•ˆæœ

### ä¿®å¤å‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚ â† ç™½è‰²èƒŒæ™¯
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ç£¨ç»ç’ƒå®¹å™¨              â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚
â”‚ â”‚  â”‚ æŒ‰é”®å¾½ç«  â”‚            â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ”‚ â† ç™½è‰²åº•è¾¹
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¿®å¤å
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                             â”‚ â† å®Œå…¨é€æ˜
â”‚                             â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚ â”‚  ç£¨ç»ç’ƒå®¹å™¨              â”‚ â”‚
â”‚ â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚ â”‚
â”‚ â”‚  â”‚ æŒ‰é”®å¾½ç«  â”‚            â”‚ â”‚
â”‚ â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚ â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                             â”‚ â† å®Œå…¨é€æ˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## å…³é”®è¦ç‚¹

### 1. å¤šå±‚é€æ˜
ç¡®ä¿æ¯ä¸€å±‚éƒ½è®¾ç½®ä¸ºé€æ˜ï¼š
- Electron çª—å£ï¼š`transparent: true`
- HTML/bodyï¼š`background: transparent !important`
- #appï¼š`background: transparent !important`
- æ ¹ç»„ä»¶ï¼š`background: transparent`

### 2. æ ·å¼ä¼˜å…ˆçº§
ä½¿ç”¨ `!important` ç¡®ä¿é€æ˜æ ·å¼ä¸è¢«è¦†ç›–ï¼š
```css
background: transparent !important;
```

### 3. å…¨å±€æ ·å¼
åœ¨ Vue ç»„ä»¶ä¸­ä½¿ç”¨é scoped æ ·å¼è®¾ç½®å…¨å±€é€æ˜ï¼š
```vue
<style>
body {
  background: transparent !important;
}
</style>
```

### 4. ç‚¹å‡»ç©¿é€
åŒæ—¶ä½¿ç”¨ Electron å’Œ CSS ä¸¤ç§æ–¹æ³•ï¼š
```typescript
// Electron
win.setIgnoreMouseEvents(true, { forward: true });
```
```css
/* CSS */
pointer-events: none;
```

## æ€§èƒ½å½±å“

### é€æ˜çª—å£çš„å¼€é”€
- **GPU ä½¿ç”¨**ï¼šç•¥æœ‰å¢åŠ ï¼ˆç”¨äºåˆæˆï¼‰
- **å†…å­˜å ç”¨**ï¼šåŸºæœ¬æ— å½±å“
- **æ¸²æŸ“æ€§èƒ½**ï¼šbackdrop-filter æœ‰ä¸€å®šå¼€é”€

### ä¼˜åŒ–æªæ–½
- âœ… é™åˆ¶çª—å£å¤§å°ï¼ˆ300x100ï¼‰
- âœ… ä½¿ç”¨ CSS åŠ¨ç”»ï¼ˆGPU åŠ é€Ÿï¼‰
- âœ… åˆç†çš„æ¨¡ç³ŠåŠå¾„ï¼ˆ10-20pxï¼‰
- âœ… è‡ªåŠ¨æ¸…ç† DOM å…ƒç´ 

## æµè§ˆå™¨å…¼å®¹æ€§

### backdrop-filter æ”¯æŒ
- âœ… Chrome/Edge 76+
- âœ… Safari 9+
- âœ… Firefox 103+

### é™çº§æ–¹æ¡ˆ
ä¸æ”¯æŒçš„æµè§ˆå™¨ä¼šæ˜¾ç¤ºçº¯è‰²èƒŒæ™¯ï¼Œä½†é€æ˜åº¦ä»ç„¶æ­£å¸¸ã€‚

## æ•…éšœæ’é™¤

### é—®é¢˜ï¼šä»ç„¶çœ‹åˆ°ç™½è‰²èƒŒæ™¯

**è§£å†³æ–¹æ¡ˆï¼š**
1. æ¸…é™¤æµè§ˆå™¨ç¼“å­˜
2. é‡å¯åº”ç”¨
3. æ£€æŸ¥ CSS æ˜¯å¦è¢«å…¶ä»–æ ·å¼è¦†ç›–
4. ä½¿ç”¨å¼€å‘è€…å·¥å…·æ£€æŸ¥è®¡ç®—åçš„æ ·å¼

### é—®é¢˜ï¼šç‚¹å‡»ç©¿é€ä¸å·¥ä½œ

**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¡®è®¤ `setIgnoreMouseEvents` å·²è°ƒç”¨
2. æ£€æŸ¥ CSS `pointer-events` è®¾ç½®
3. éªŒè¯æ²¡æœ‰å­å…ƒç´ è®¾ç½® `pointer-events: auto`

### é—®é¢˜ï¼šç£¨ç»ç’ƒæ•ˆæœå¼‚å¸¸

**è§£å†³æ–¹æ¡ˆï¼š**
1. ç¡®è®¤çª—å£é€æ˜é…ç½®æ­£ç¡®
2. æ£€æŸ¥æµè§ˆå™¨æ˜¯å¦æ”¯æŒ backdrop-filter
3. å°è¯•è°ƒæ•´æ¨¡ç³ŠåŠå¾„

## ç›¸å…³æ–‡æ¡£

- ğŸ“– [é€æ˜çª—å£é…ç½®è¯¦è§£](./TRANSPARENT_WINDOW_SETUP.md)
- ğŸ¨ [UI è®¾è®¡è¯¦è§£](./KEYBOARD_UI_DESIGN.md)
- ğŸ“ [åŠŸèƒ½è¯´æ˜](./KEYBOARD_HIGHLIGHT_FEATURE.md)
- ğŸ”§ [å¿«é€Ÿå‚è€ƒ](./QUICK_REFERENCE.md)

## æ€»ç»“

é€šè¿‡åœ¨ HTMLã€Vue ç»„ä»¶å’Œ Electron çª—å£ä¸‰ä¸ªå±‚é¢è®¾ç½®é€æ˜èƒŒæ™¯ï¼ŒæˆåŠŸè§£å†³äº†ç™½è‰²åº•è¾¹é—®é¢˜ï¼ŒåŒæ—¶ç¡®ä¿äº†ç‚¹å‡»ç©¿é€åŠŸèƒ½æ­£å¸¸å·¥ä½œã€‚ç°åœ¨é”®ç›˜æŒ‰é”®è¦†ç›–å±‚çª—å£å®Œå…¨é€æ˜ï¼Œåªæ˜¾ç¤ºç£¨ç»ç’ƒæ•ˆæœçš„å®¹å™¨å’ŒæŒ‰é”®å¾½ç« ï¼Œè§†è§‰æ•ˆæœæ›´åŠ ç¾è§‚ï¼Œç”¨æˆ·ä½“éªŒæ›´åŠ æµç•…ã€‚
